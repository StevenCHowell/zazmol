<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>operate &mdash; sasmol 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="sasmol 1.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for operate</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1">#from __future__ import unicode_literals</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    SASMOL: Copyright (C) 2011 Joseph E. Curtis, Ph.D. </span>

<span class="sd">    This program is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License</span>
<span class="sd">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">sasmol</span> <span class="kn">as</span> <span class="nn">sasmol</span>
<span class="kn">import</span> <span class="nn">sasmol.linear_algebra</span> <span class="kn">as</span> <span class="nn">linear_algebra</span>

<span class="c1">#	OPERATE</span>
<span class="c1">#</span>
<span class="c1">#	12/13/2009	--	initial coding			        :	jc</span>
<span class="c1">#   07/23/2016  --  refactored for release          :   jc</span>
<span class="c1">#   07/23/2016  --  refactored for Python 3         :   jc</span>
<span class="c1">#</span>
<span class="c1">#	 1         2         3         4         5         6         7</span>
<span class="c1"># LC4567890123456789012345678901234567890123456789012345678901234567890123456789</span>
<span class="c1">#								       *      **</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Operate contains the classes and methods to perform the basic</span>
<span class="sd">	translation, rotation, and alignment operations on instances of objects </span>
<span class="sd">	described in the sasmol module.</span>

<span class="sd">	The methods in this class move entire objects, not pieces</span>
<span class="sd">	of single objects (i.e. no intra-object movements)</span>
<span class="sd">&#39;&#39;&#39;</span>


<div class="viewcode-block" id="Move"><a class="viewcode-back" href="../index_operate.html#operate.Move">[docs]</a><span class="k">class</span> <span class="nc">Move</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot; Base class containing methods to perform basic translation, rotation,</span>
<span class="sd">        and alignment operations on instances of system objects.</span>

<span class="sd">        The methods in this class move entire objects, not pieces</span>
<span class="sd">        of single objects (i.e. no intra-object movements)</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        First example shows how to use class methods from system object:</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system ; import math</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0 ; axis = &#39;x&#39; ; theta = 45.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; molecule.rotate(frame, axis, theta)</span>

<span class="sd">        Second example shows how to use class methods directly:</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system ; import math</span>
<span class="sd">        &gt;&gt;&gt; import sasmol.operate as operate</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0 ; axis = &#39;x&#39; ; theta = 45.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; operate.Move.rotate(molecule, frame, axis, theta) </span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>

<span class="sd">        `self` parameter is not shown in the ``Parameters`` section in the documentation</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="sd">&#39;&#39;&#39;</span>


<span class="sd">        moveto moves the COM to a point in space (x,y,z)</span>

<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="Move.mass_check"><a class="viewcode-back" href="../index_operate.html#operate.Move.mass_check">[docs]</a>    <span class="k">def</span> <span class="nf">mass_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        mass_check determines if mass is defined for the object so that</span>
<span class="sd">        center of mass can be calculated</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>
<span class="sd">                                                                                     </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._total_mass</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; molecule.mass_check()</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span> 
          
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_mass</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_mass</span><span class="p">()</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="Move.translate"><a class="viewcode-back" href="../index_operate.html#operate.Move.translate">[docs]</a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        </span>
<span class="sd">        translate moves the object </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>

<span class="sd">        value </span>
<span class="sd">            list of x, y, z float values</span>

<span class="sd">        kwargs </span>
<span class="sd">            point = True : will translate to a fixed point</span>
<span class="sd">                           given by value variable                                                                             </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor and self._center_of_mass</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0</span>
<span class="sd">        &gt;&gt;&gt; molecule.calculate_center_of_mass(frame)</span>
<span class="sd">        array([ -6.79114736, -23.71577133,   8.06558513])</span>
<span class="sd">        &gt;&gt;&gt; displacement = [3.0, 4.0, 5.0]</span>
<span class="sd">        &gt;&gt;&gt; molecule.translate(frame, displacement)</span>
<span class="sd">        &gt;&gt;&gt; molecule.calculate_center_of_mass(frame)</span>
<span class="sd">        array([ -3.79114736, -19.71577133,  13.06558513])</span>
<span class="sd">      </span>
<span class="sd">         </span>
<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0</span>
<span class="sd">        &gt;&gt;&gt; final_position = [3.0, 4.0, 5.0]</span>
<span class="sd">        &gt;&gt;&gt; molecule.translate(frame, final_position, point=True)</span>
<span class="sd">        &gt;&gt;&gt; molecule.calculate_center_of_mass(frame)  </span>
<span class="sd">        array([ 3.,  4.,  5.])</span>
<span class="sd">         </span>
<span class="sd">        Note </span>
<span class="sd">        ----------</span>
<span class="sd">        mass_check is called to validate self._total_mass()    </span>


<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="n">point_flag</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;point&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">point_flag</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_check</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">point_flag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_com</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
         
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_com</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Move.center"><a class="viewcode-back" href="../index_operate.html#operate.Move.center">[docs]</a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Method moves the center of mass of object to [0.0, 0.0, 0.0]</span>
<span class="sd">       </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>
<span class="sd">                                                                                     </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor and self._center_of_mass</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0</span>
<span class="sd">        &gt;&gt;&gt; molecule.calculate_center_of_mass(frame)</span>
<span class="sd">        array([ -6.79114736, -23.71577133,   8.06558513])</span>
<span class="sd">        &gt;&gt;&gt; molecule.center(frame)</span>
<span class="sd">        &gt;&gt;&gt; molecule.calculate_center_of_mass(frame)</span>
<span class="sd">        array([  7.11544707e-13,   2.48159571e-12,  -8.45832820e-13])</span>

<span class="sd">        Note </span>
<span class="sd">        ----------</span>
<span class="sd">        mass_check is called to validate self._total_mass()    </span>
<span class="sd">        </span>
<span class="sd">        Can achieve same result using self.translate(frame, [0,0,0], point=True)</span>

<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mass_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_com</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_com</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_com</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="k">return</span></div>
    
<div class="viewcode-block" id="Move.align"><a class="viewcode-back" href="../index_operate.html#operate.Move.align">[docs]</a>    <span class="k">def</span> <span class="nf">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">self_basis</span><span class="p">,</span> <span class="n">other_basis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Alignment of one object on top of another</span>
<span class="sd">            &quot;self&quot; is aligned onto &quot;other&quot; using the basis</span>
<span class="sd">            of molecule 2 to align onto the basis of molecule 1</span>
<span class="sd">            and the transformation is then done to all the atoms of</span>
<span class="sd">            molecule 2</span>

<span class="sd">            self = molecule_2</span>

<span class="sd">            other = molecule_1</span>

<span class="sd">            self aligned to other</span>

<span class="sd">            molecule_2 aligned to molecule_1</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>
<span class="sd">        </span>
<span class="sd">        other</span>
<span class="sd">            system object : molecule 1</span>

<span class="sd">        self_basis</span>
<span class="sd">            string : unique description of atoms used for alignment</span>

<span class="sd">        other_basis</span>
<span class="sd">            string : unique description of atoms used for alignment</span>
<span class="sd">        </span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule_1 = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; molecule_2 = system.Molecule(&#39;moved_and_rotated_hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0</span>
<span class="sd">        &gt;&gt;&gt; basis_1 = &#39;name[i] == &quot;CA&quot;&#39;</span>
<span class="sd">        &gt;&gt;&gt; basis_2 = &#39;name[i] == &quot;CA&quot;&#39;</span>
<span class="sd">        &gt;&gt;&gt; molecule_2.align(molecule_1, basis_1, basis_2)</span>
<span class="sd">        &gt;&gt;&gt; com_sub_2 = molecule_2.calculate_center_of_mass(frame)</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        mass_check determines if mass is defined for the object so that</span>
<span class="sd">        center of mass can be calculated</span>
<span class="sd">         </span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>


        <span class="c1">### other = molecule_1 (reference)</span>
        
        <span class="n">error</span><span class="p">,</span> <span class="n">other_mask</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_subset_mask</span><span class="p">(</span><span class="n">other_basis</span><span class="p">)</span>
        
        <span class="n">subset_other</span> <span class="o">=</span> <span class="n">sasmol</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">Molecule</span><span class="p">()</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">copy_molecule_using_mask</span><span class="p">(</span><span class="n">subset_other</span><span class="p">,</span> <span class="n">other_mask</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span> 
        
        <span class="n">com_subset_other</span> <span class="o">=</span> <span class="n">subset_other</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">subset_other</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">coor_subset_other</span> <span class="o">=</span> <span class="n">subset_other</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">]</span>
       

        <span class="c1">### self = molecule_2 (to be aligned to other / molecule_1)</span>

        <span class="n">error</span><span class="p">,</span> <span class="n">self_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subset_mask</span><span class="p">(</span><span class="n">self_basis</span><span class="p">)</span>
        
        <span class="n">subset_self</span> <span class="o">=</span> <span class="n">sasmol</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">Molecule</span><span class="p">()</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_molecule_using_mask</span><span class="p">(</span><span class="n">subset_self</span><span class="p">,</span> <span class="n">self_mask</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span> 
        
        <span class="n">com_subset_self</span> <span class="o">=</span> <span class="n">subset_self</span><span class="o">.</span><span class="n">calculate_center_of_mass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">subset_self</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">coor_subset_self</span> <span class="o">=</span> <span class="n">subset_self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">]</span>
       
        
        <span class="n">u</span> <span class="o">=</span> <span class="n">linear_algebra</span><span class="o">.</span><span class="n">find_u</span><span class="p">(</span><span class="n">coor_subset_self</span><span class="p">,</span> <span class="n">coor_subset_other</span><span class="p">)</span>

        <span class="n">tao</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">]</span> <span class="o">-</span> <span class="n">com_subset_other</span><span class="p">)</span>

        <span class="n">error</span><span class="p">,</span> <span class="n">nat2</span> <span class="o">=</span> <span class="n">linear_algebra</span><span class="o">.</span><span class="n">matrix_multiply</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">tao</span><span class="p">)</span>

        <span class="n">ncoor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">nat2</span><span class="p">)</span> <span class="o">+</span> <span class="n">com_subset_other</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ncoor</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Move.rotate"><a class="viewcode-back" href="../index_operate.html#operate.Move.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Simple rotation about the x, y, or z axis.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>

<span class="sd">        axis </span>
<span class="sd">            string : &#39;x&#39;, &#39;y&#39;, or &#39;z&#39;</span>

<span class="sd">        theta </span>
<span class="sd">            float : angle in radians</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments        </span>
<span class="sd">       </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor </span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system ; import math</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0 ; axis = &#39;x&#39; ; theta = 45.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; molecule.rotate(frame, axis, theta)</span>
<span class="sd"> </span>
<span class="sd">        Note </span>
<span class="sd">        ----------</span>
<span class="sd">        Calculations are carried out using radians</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">cs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">si</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">):</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="o">-</span><span class="n">si</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">cs</span><span class="p">]])</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">):</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[[</span><span class="n">cs</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">si</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">si</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">cs</span><span class="p">]])</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">):</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[[</span><span class="n">cs</span><span class="p">,</span> <span class="o">-</span><span class="n">si</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="n">si</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>

        <span class="n">coordt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">error</span><span class="p">,</span> <span class="n">matrix_product</span> <span class="o">=</span> <span class="n">linear_algebra</span><span class="o">.</span><span class="n">matrix_multiply</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">coordt</span><span class="p">)</span>
        <span class="n">ncoord</span> <span class="o">=</span> <span class="n">matrix_product</span><span class="o">.</span><span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coor</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ncoord</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Move.rotate_general_axis"><a class="viewcode-back" href="../index_operate.html#operate.Move.rotate_general_axis">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_general_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">unit_axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            The general rotation of a molecule along an arbitrarily</span>
<span class="sd">            given unit axis (ux,uy,uz) by an angle theta.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>

<span class="sd">        theta </span>
<span class="sd">            float : angle in radians</span>
<span class="sd">        </span>
<span class="sd">        unit_axis</span>
<span class="sd">            float : [ux, uy, uz] components of unit axis</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments        </span>
<span class="sd">       </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor </span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system ; import math</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0 ; theta = 45.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; unit_axis = [ 0.2, 1.3, -3.5 ]</span>
<span class="sd">        &gt;&gt;&gt; molecule.rotate_general_axis(frame, theta, unit_axis)</span>
<span class="sd"> </span>
<span class="sd">        Note </span>
<span class="sd">        ----------</span>
<span class="sd">        Calculations are carried out using radians</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ux</span> <span class="o">=</span> <span class="n">unit_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">uy</span> <span class="o">=</span> <span class="n">unit_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">uz</span> <span class="o">=</span> <span class="n">unit_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">c11</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ux</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="n">c12</span> <span class="o">=</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c13</span> <span class="o">=</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c21</span> <span class="o">=</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c22</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">uy</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="n">c23</span> <span class="o">=</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c31</span> <span class="o">=</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c32</span> <span class="o">=</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c33</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">uz</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

        <span class="n">C</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">c11</span><span class="p">,</span> <span class="n">c12</span><span class="p">,</span> <span class="n">c13</span><span class="p">],</span> <span class="p">[</span><span class="n">c21</span><span class="p">,</span> <span class="n">c22</span><span class="p">,</span> <span class="n">c23</span><span class="p">],</span> <span class="p">[</span><span class="n">c31</span><span class="p">,</span> <span class="n">c32</span><span class="p">,</span> <span class="n">c33</span><span class="p">]])</span>

        <span class="n">coor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">]</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">coor</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Move.rotate_euler"><a class="viewcode-back" href="../index_operate.html#operate.Move.rotate_euler">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_euler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Rotate the molecule by a euler angle set (phi,theta,psi)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame </span>
<span class="sd">            integer : trajectory frame number to use</span>

<span class="sd">        phi </span>
<span class="sd">            float : phi angle</span>

<span class="sd">        theta </span>
<span class="sd">            float : theta angle</span>

<span class="sd">        psi </span>
<span class="sd">            float : psi angle</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments        </span>
<span class="sd">       </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            updated self._coor </span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system ; import math</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; frame = 0 </span>
<span class="sd">        &gt;&gt;&gt; phi = 45.0 * math.pi / 180.0 </span>
<span class="sd">        &gt;&gt;&gt; theta = 45.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; psi = 32.0 * math.pi / 180.0</span>
<span class="sd">        &gt;&gt;&gt; molecule.euler_rotate(frame, phi, theta, psi)</span>
<span class="sd"> </span>
<span class="sd">        Note </span>
<span class="sd">        ----------</span>
<span class="sd">        Calculations are carried out using radians</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">c11</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c12</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c13</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">-</span> \
                <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c21</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c22</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">-</span> \
                <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c23</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">c31</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c32</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">c33</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">C</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
                <span class="p">[[</span><span class="n">c11</span><span class="p">,</span> <span class="n">c12</span><span class="p">,</span> <span class="n">c13</span><span class="p">],</span> <span class="p">[</span><span class="n">c21</span><span class="p">,</span> <span class="n">c22</span><span class="p">,</span> <span class="n">c23</span><span class="p">],</span> <span class="p">[</span><span class="n">c31</span><span class="p">,</span> <span class="n">c32</span><span class="p">,</span> <span class="n">c33</span><span class="p">]])</span>

        <span class="n">coor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">]</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="n">frame</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">coor</span>

        <span class="k">return</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Joseph E. Curtis, Ph.D..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
    </div>

    

    
  </body>
</html>