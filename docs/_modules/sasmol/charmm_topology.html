<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sasmol.charmm_topology &mdash; sasmol 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="sasmol 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sasmol.charmm_topology</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1">#from __future__ import unicode_literals</span>

<span class="c1">#   SASMOL: Copyright (C) 2011 Joseph E. Curtis, Ph.D. </span>
<span class="c1">#</span>
<span class="c1">#    This program is free software: you can redistribute it and/or modify</span>
<span class="c1">#    it under the terms of the GNU General Public License as published by</span>
<span class="c1">#    the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">#    (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#    This program is distributed in the hope that it will be useful,</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">#    GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#    You should have received a copy of the GNU General Public License</span>
<span class="c1">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1">#	TOPOLOGY</span>
<span class="c1">#</span>
<span class="c1">#	1/26/2012	--	initial coding				: jc</span>
<span class="c1">#	12/26/2015	--	refactored for release      : jc</span>
<span class="c1">#	08/18/2016	--	documentation               : jc</span>
<span class="c1">#</span>
<span class="c1">#	 1         2         3         4         5         6         7</span>
<span class="c1"># LC4567890123456789012345678901234567890123456789012345678901234567890123456789</span>
<span class="c1">#								       *      **</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">sasmol.config</span> <span class="kn">as</span> <span class="nn">config</span>

<span class="k">class</span> <span class="nc">CharmmTopology</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class contains charmm topology information used other modules.</span>


<span class="sd">    The output topology dictionary looks like the following examples:</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; import pprint</span>
<span class="sd">    &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">    &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">    &gt;&gt;&gt; test.read_charmm_topology()</span>
<span class="sd">    &gt;&gt;&gt; pprint.pprint(test.topology_info[&#39;NTER&#39;],width=100)</span>
<span class="sd">    {&#39;ATOM&#39;: [[&#39;N&#39;, &#39;NH3&#39;, &#39;-0.30&#39;],</span>
<span class="sd">          [&#39;HT1&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">          [&#39;HT2&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">          [&#39;HT3&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">          [&#39;CA&#39;, &#39;CT1&#39;, &#39;0.21&#39;],</span>
<span class="sd">          [&#39;HA&#39;, &#39;HB&#39;, &#39;0.10&#39;]],</span>
<span class="sd">    &#39;BOND&#39;: [[&#39;HT1&#39;, &#39;N&#39;], [&#39;HT2&#39;, &#39;N&#39;], [&#39;HT3&#39;, &#39;N&#39;]],</span>
<span class="sd">    &#39;DELE&#39;: [[&#39;ATOM&#39;, &#39;HN&#39;]],</span>
<span class="sd">    &#39;DONO&#39;: [&#39;HT1&#39;, &#39;N&#39;, &#39;HT2&#39;, &#39;N&#39;, &#39;HT3&#39;, &#39;N&#39;],</span>
<span class="sd">    &#39;IC&#39;: [[&#39;HT1&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;180.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;],</span>
<span class="sd">            [&#39;HT2&#39;, &#39;CA&#39;, &#39;*N&#39;, &#39;HT1&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;120.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;],</span>
<span class="sd">            [&#39;HT3&#39;, &#39;CA&#39;, &#39;*N&#39;, &#39;HT2&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;120.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;]],</span>
<span class="sd">    &#39;TOTAL_CHARGE&#39;: &#39;1.00&#39;}</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import pprint</span>
<span class="sd">    &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">    &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">    &gt;&gt;&gt; test.read_charmm_topology()</span>
<span class="sd">    &gt;&gt;&gt; pprint.pprint(test.topology_info[&#39;ALA&#39;],width=100)</span>
<span class="sd">    {&#39;ACCE&#39;: [&#39;O&#39;, &#39;C&#39;],</span>
<span class="sd">    &#39;ATOM&#39;: [[&#39;N&#39;, &#39;NH1&#39;, &#39;-0.47&#39;],</span>
<span class="sd">            [&#39;HN&#39;, &#39;H&#39;, &#39;0.31&#39;],</span>
<span class="sd">            [&#39;CA&#39;, &#39;CT1&#39;, &#39;0.07&#39;],</span>
<span class="sd">            [&#39;HA&#39;, &#39;HB&#39;, &#39;0.09&#39;],</span>
<span class="sd">            [&#39;CB&#39;, &#39;CT3&#39;, &#39;-0.27&#39;],</span>
<span class="sd">            [&#39;HB1&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">            [&#39;HB2&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">            [&#39;HB3&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">            [&#39;C&#39;, &#39;C&#39;, &#39;0.51&#39;],</span>
<span class="sd">            [&#39;O&#39;, &#39;O&#39;, &#39;-0.51&#39;]],</span>
<span class="sd">    &#39;BOND&#39;: [[&#39;CB&#39;, &#39;CA&#39;],</span>
<span class="sd">            [&#39;N&#39;, &#39;HN&#39;],</span>
<span class="sd">            [&#39;N&#39;, &#39;CA&#39;],</span>
<span class="sd">            [&#39;C&#39;, &#39;CA&#39;],</span>
<span class="sd">            [&#39;C&#39;, &#39;+N&#39;],</span>
<span class="sd">            [&#39;CA&#39;, &#39;HA&#39;],</span>
<span class="sd">            [&#39;CB&#39;, &#39;HB1&#39;],</span>
<span class="sd">            [&#39;CB&#39;, &#39;HB2&#39;],</span>
<span class="sd">            [&#39;CB&#39;, &#39;HB3&#39;]],</span>
<span class="sd">    &#39;DONO&#39;: [&#39;HN&#39;, &#39;N&#39;],</span>
<span class="sd">    &#39;DOUB&#39;: [[&#39;O&#39;, &#39;C&#39;]],</span>
<span class="sd">    &#39;IC&#39;: [[&#39;-C&#39;, &#39;CA&#39;, &#39;*N&#39;, &#39;HN&#39;, &#39;1.3551&#39;, &#39;126.4900&#39;, &#39;180.0000&#39;, &#39;115.4200&#39;, &#39;0.9996&#39;],</span>
<span class="sd">            [&#39;-C&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;1.3551&#39;, &#39;126.4900&#39;, &#39;180.0000&#39;, &#39;114.4400&#39;, &#39;1.5390&#39;],</span>
<span class="sd">            [&#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;+N&#39;, &#39;1.4592&#39;, &#39;114.4400&#39;, &#39;180.0000&#39;, &#39;116.8400&#39;, &#39;1.3558&#39;],</span>
<span class="sd">            [&#39;+N&#39;, &#39;CA&#39;, &#39;*C&#39;, &#39;O&#39;, &#39;1.3558&#39;, &#39;116.8400&#39;, &#39;180.0000&#39;, &#39;122.5200&#39;, &#39;1.2297&#39;],</span>
<span class="sd">            [&#39;CA&#39;, &#39;C&#39;, &#39;+N&#39;, &#39;+CA&#39;, &#39;1.5390&#39;, &#39;116.8400&#39;, &#39;180.0000&#39;, &#39;126.7700&#39;, &#39;1.4613&#39;],</span>
<span class="sd">            [&#39;N&#39;, &#39;C&#39;, &#39;*CA&#39;, &#39;CB&#39;, &#39;1.4592&#39;, &#39;114.4400&#39;, &#39;123.2300&#39;, &#39;111.0900&#39;, &#39;1.5461&#39;],</span>
<span class="sd">            [&#39;N&#39;, &#39;C&#39;, &#39;*CA&#39;, &#39;HA&#39;, &#39;1.4592&#39;, &#39;114.4400&#39;, &#39;-120.4500&#39;, &#39;106.3900&#39;, &#39;1.0840&#39;],</span>
<span class="sd">            [&#39;C&#39;, &#39;CA&#39;, &#39;CB&#39;, &#39;HB1&#39;, &#39;1.5390&#39;, &#39;111.0900&#39;, &#39;177.2500&#39;, &#39;109.6000&#39;, &#39;1.1109&#39;],</span>
<span class="sd">            [&#39;HB1&#39;, &#39;CA&#39;, &#39;*CB&#39;, &#39;HB2&#39;, &#39;1.1109&#39;, &#39;109.6000&#39;, &#39;119.1300&#39;, &#39;111.0500&#39;, &#39;1.1119&#39;],</span>
<span class="sd">            [&#39;HB1&#39;, &#39;CA&#39;, &#39;*CB&#39;, &#39;HB3&#39;, &#39;1.1109&#39;, &#39;109.6000&#39;, &#39;-119.5800&#39;, &#39;111.6100&#39;, &#39;1.1114&#39;]],</span>
<span class="sd">    &#39;IMPR&#39;: [[&#39;N&#39;, &#39;-C&#39;, &#39;CA&#39;, &#39;HN&#39;], [&#39;C&#39;, &#39;CA&#39;, &#39;+N&#39;, &#39;O&#39;]],</span>


<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">    </span>
<span class="sd">        `self` parameter is not shown in the ``Parameters`` section in the documentation</span>


<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">charmm_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>
<span class="sd">                                                                                     </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        charmm_names</span>
<span class="sd">            dictionary : atom_name and list of atom names for</span>
<span class="sd">            hydrogen, carbon, nitrogen, oxygen, sulfur, phosphorus, other</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.properties as properties</span>
<span class="sd">        &gt;&gt;&gt; properties = properties.Atomic()</span>
<span class="sd">        &gt;&gt;&gt; properties.charmm_names()[&#39;sulfur&#39;]</span>
<span class="sd">        [&#39;SG&#39;, &#39;SD&#39;, &#39;1SG&#39;, &#39;2SG&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">charmm_names</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HN&#39;</span><span class="p">,</span> <span class="s1">&#39;HA&#39;</span><span class="p">,</span> <span class="s1">&#39;HB1&#39;</span><span class="p">,</span> <span class="s1">&#39;HB2&#39;</span><span class="p">,</span> <span class="s1">&#39;HB3&#39;</span><span class="p">,</span> <span class="s1">&#39;HG1&#39;</span><span class="p">,</span> <span class="s1">&#39;HG2&#39;</span><span class="p">,</span> <span class="s1">&#39;HD1&#39;</span><span class="p">,</span> <span class="s1">&#39;HD2&#39;</span><span class="p">,</span> <span class="s1">&#39;HE&#39;</span><span class="p">,</span> <span class="s1">&#39;HH11&#39;</span><span class="p">,</span> <span class="s1">&#39;HH12&#39;</span><span class="p">,</span> <span class="s1">&#39;HH21&#39;</span><span class="p">,</span> <span class="s1">&#39;HH22&#39;</span><span class="p">,</span> <span class="s1">&#39;HD21&#39;</span><span class="p">,</span> <span class="s1">&#39;HD22&#39;</span><span class="p">,</span> <span class="s1">&#39;HE21&#39;</span><span class="p">,</span> <span class="s1">&#39;HE22&#39;</span><span class="p">,</span> <span class="s1">&#39;HA1&#39;</span><span class="p">,</span> <span class="s1">&#39;HA2&#39;</span><span class="p">,</span> <span class="s1">&#39;HE1&#39;</span><span class="p">,</span> <span class="s1">&#39;HE2&#39;</span><span class="p">,</span> <span class="s1">&#39;HB&#39;</span><span class="p">,</span> <span class="s1">&#39;HG21&#39;</span><span class="p">,</span> <span class="s1">&#39;HG22&#39;</span><span class="p">,</span> <span class="s1">&#39;HG23&#39;</span><span class="p">,</span> <span class="s1">&#39;HG11&#39;</span><span class="p">,</span> <span class="s1">&#39;HG12&#39;</span><span class="p">,</span> <span class="s1">&#39;HD3&#39;</span><span class="p">,</span> <span class="s1">&#39;HG&#39;</span><span class="p">,</span> <span class="s1">&#39;HD11&#39;</span><span class="p">,</span> <span class="s1">&#39;HD12&#39;</span><span class="p">,</span> <span class="s1">&#39;HD13&#39;</span><span class="p">,</span> <span class="s1">&#39;HD23&#39;</span><span class="p">,</span> <span class="s1">&#39;HZ1&#39;</span><span class="p">,</span> <span class="s1">&#39;HZ2&#39;</span><span class="p">,</span> <span class="s1">&#39;HZ3&#39;</span><span class="p">,</span> <span class="s1">&#39;HE3&#39;</span><span class="p">,</span> <span class="s1">&#39;HZ&#39;</span><span class="p">,</span> <span class="s1">&#39;HH2&#39;</span><span class="p">,</span> <span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;HG13&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;HC&#39;</span><span class="p">,</span> <span class="s1">&#39;HD&#39;</span><span class="p">,</span> <span class="s1">&#39;HMA1&#39;</span><span class="p">,</span> <span class="s1">&#39;HMA2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMA3&#39;</span><span class="p">,</span> <span class="s1">&#39;HAA1&#39;</span><span class="p">,</span> <span class="s1">&#39;HAA2&#39;</span><span class="p">,</span> <span class="s1">&#39;HBA1&#39;</span><span class="p">,</span> <span class="s1">&#39;HBA2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMB1&#39;</span><span class="p">,</span> <span class="s1">&#39;HMB2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMB3&#39;</span><span class="p">,</span> <span class="s1">&#39;HAB&#39;</span><span class="p">,</span> <span class="s1">&#39;HBB1&#39;</span><span class="p">,</span> <span class="s1">&#39;HBB2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMC1&#39;</span><span class="p">,</span> <span class="s1">&#39;HMC2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMC3&#39;</span><span class="p">,</span> <span class="s1">&#39;HAC&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC1&#39;</span><span class="p">,</span> <span class="s1">&#39;HBC2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMD1&#39;</span><span class="p">,</span> <span class="s1">&#39;HMD2&#39;</span><span class="p">,</span> <span class="s1">&#39;HMD3&#39;</span><span class="p">,</span> <span class="s1">&#39;HAD1&#39;</span><span class="p">,</span> <span class="s1">&#39;HAD2&#39;</span><span class="p">,</span> <span class="s1">&#39;HBD1&#39;</span><span class="p">,</span> <span class="s1">&#39;HBD2&#39;</span><span class="p">,</span> <span class="s1">&#39;HT1&#39;</span><span class="p">,</span> <span class="s1">&#39;HT2&#39;</span><span class="p">,</span> <span class="s1">&#39;HT3&#39;</span><span class="p">,</span> <span class="s1">&#39;HN1&#39;</span><span class="p">,</span> <span class="s1">&#39;HN2&#39;</span><span class="p">,</span> <span class="s1">&#39;HY1&#39;</span><span class="p">,</span> <span class="s1">&#39;HY2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;HY3&#39;</span><span class="p">,</span> <span class="s1">&#39;HNT&#39;</span><span class="p">,</span> <span class="s2">&quot;H5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H5&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;H21&#39;</span><span class="p">,</span> <span class="s1">&#39;H22&#39;</span><span class="p">,</span> <span class="s1">&#39;H8&#39;</span><span class="p">,</span> <span class="s2">&quot;H2&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;H61&#39;</span><span class="p">,</span> <span class="s1">&#39;H62&#39;</span><span class="p">,</span> <span class="s1">&#39;H6&#39;</span><span class="p">,</span> <span class="s1">&#39;H5&#39;</span><span class="p">,</span> <span class="s1">&#39;H41&#39;</span><span class="p">,</span> <span class="s1">&#39;H42&#39;</span><span class="p">,</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span> <span class="s1">&#39;H51&#39;</span><span class="p">,</span> <span class="s1">&#39;H52&#39;</span><span class="p">,</span> <span class="s1">&#39;H53&#39;</span><span class="p">,</span> <span class="s1">&#39;H11&#39;</span><span class="p">,</span> <span class="s1">&#39;H12&#39;</span><span class="p">,</span> <span class="s1">&#39;H13&#39;</span><span class="p">,</span> <span class="s1">&#39;H23&#39;</span><span class="p">,</span> <span class="s1">&#39;H9&#39;</span><span class="p">,</span> <span class="s1">&#39;H5T&#39;</span><span class="p">,</span> <span class="s2">&quot;H53&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;H5T1&#39;</span><span class="p">,</span> <span class="s1">&#39;H5T2&#39;</span><span class="p">,</span> <span class="s1">&#39;H5T3&#39;</span><span class="p">,</span> <span class="s1">&#39;H3T&#39;</span><span class="p">,</span> <span class="s1">&#39;H3T1&#39;</span><span class="p">,</span> <span class="s1">&#39;H3T2&#39;</span><span class="p">,</span> <span class="s1">&#39;H3T3&#39;</span><span class="p">,</span> <span class="s1">&#39;H91&#39;</span><span class="p">,</span> <span class="s1">&#39;H92&#39;</span><span class="p">,</span> <span class="s1">&#39;H93&#39;</span><span class="p">,</span> <span class="s1">&#39;H9B1&#39;</span><span class="p">,</span> <span class="s1">&#39;H9B2&#39;</span><span class="p">,</span> <span class="s1">&#39;H9B3&#39;</span><span class="p">,</span> <span class="s1">&#39;H5M1&#39;</span><span class="p">,</span> <span class="s1">&#39;H5M2&#39;</span><span class="p">,</span> <span class="s1">&#39;H5M3&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;H15&#39;</span><span class="p">,</span> <span class="s1">&#39;H16&#39;</span><span class="p">,</span> <span class="s1">&#39;H17&#39;</span><span class="p">,</span> <span class="s2">&quot;H11&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H12&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H21&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H22&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H31&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H32&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H41&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H42&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H51&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H52&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H1&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H4&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;H3&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;1H3&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;1H3&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;1H2&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;2H5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;2H5&#39;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AH4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AH1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AH8&#39;</span><span class="p">,</span> <span class="s1">&#39;AH2&#39;</span><span class="p">,</span> <span class="s2">&quot;AH2&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AH61&#39;</span><span class="p">,</span> <span class="s1">&#39;AH62&#39;</span><span class="p">,</span> <span class="s1">&#39;AH2T&#39;</span><span class="p">,</span> <span class="s2">&quot;AH3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AH3T&#39;</span><span class="p">,</span> <span class="s2">&quot;AH5&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AH5S&#39;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;carbon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="s2">&quot;CD&quot;</span><span class="p">,</span> <span class="s2">&quot;CZ&quot;</span><span class="p">,</span> <span class="s2">&quot;CE1&quot;</span><span class="p">,</span> <span class="s2">&quot;CD2&quot;</span><span class="p">,</span> <span class="s2">&quot;CG2&quot;</span><span class="p">,</span> <span class="s2">&quot;CG1&quot;</span><span class="p">,</span> <span class="s2">&quot;CD1&quot;</span><span class="p">,</span> <span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="s2">&quot;CE2&quot;</span><span class="p">,</span> <span class="s2">&quot;CE3&quot;</span><span class="p">,</span> <span class="s2">&quot;CZ3&quot;</span><span class="p">,</span> <span class="s2">&quot;CZ2&quot;</span><span class="p">,</span> <span class="s2">&quot;CH2&quot;</span><span class="p">,</span> <span class="s2">&quot;C1A&quot;</span><span class="p">,</span> <span class="s2">&quot;C2A&quot;</span><span class="p">,</span> <span class="s2">&quot;C3A&quot;</span><span class="p">,</span> <span class="s2">&quot;C4A&quot;</span><span class="p">,</span> <span class="s2">&quot;C1B&quot;</span><span class="p">,</span> <span class="s1">&#39;C2B&#39;</span><span class="p">,</span> <span class="s1">&#39;C3B&#39;</span><span class="p">,</span> <span class="s1">&#39;C4B&#39;</span><span class="p">,</span> <span class="s1">&#39;C1C&#39;</span><span class="p">,</span> <span class="s1">&#39;C2C&#39;</span><span class="p">,</span> <span class="s1">&#39;C3C&#39;</span><span class="p">,</span> <span class="s1">&#39;C4C&#39;</span><span class="p">,</span> <span class="s1">&#39;C1D&#39;</span><span class="p">,</span> <span class="s1">&#39;C2D&#39;</span><span class="p">,</span> <span class="s1">&#39;C3D&#39;</span><span class="p">,</span> <span class="s1">&#39;C4D&#39;</span><span class="p">,</span> <span class="s1">&#39;CHA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHB&#39;</span><span class="p">,</span> <span class="s1">&#39;CHC&#39;</span><span class="p">,</span> <span class="s1">&#39;CHD&#39;</span><span class="p">,</span> <span class="s1">&#39;CMA&#39;</span><span class="p">,</span> <span class="s1">&#39;CAA&#39;</span><span class="p">,</span> <span class="s1">&#39;CBA&#39;</span><span class="p">,</span> <span class="s1">&#39;CGA&#39;</span><span class="p">,</span> <span class="s1">&#39;CMB&#39;</span><span class="p">,</span> <span class="s1">&#39;CAB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBB&#39;</span><span class="p">,</span> <span class="s1">&#39;CMC&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;CAC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CMD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CBD&#39;</span><span class="p">,</span> <span class="s1">&#39;CGD&#39;</span><span class="p">,</span> <span class="s1">&#39;CAY&#39;</span><span class="p">,</span> <span class="s1">&#39;CY&#39;</span><span class="p">,</span> <span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="s1">&#39;CAT&#39;</span><span class="p">,</span> <span class="s2">&quot;C5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;C4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;C1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C8&#39;</span><span class="p">,</span> <span class="s2">&quot;C2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;C3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;C5M&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C5T&#39;</span><span class="p">,</span> <span class="s1">&#39;C3T&#39;</span><span class="p">,</span> <span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="s1">&#39;C9B&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="s1">&#39;C10&#39;</span><span class="p">,</span> <span class="s1">&#39;C12&#39;</span><span class="p">,</span> <span class="s1">&#39;1CB&#39;</span><span class="p">,</span> <span class="s1">&#39;2CB&#39;</span><span class="p">,</span> <span class="s2">&quot;1C3&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;1C2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;2C5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AC4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AC1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AC5&#39;</span><span class="p">,</span> <span class="s1">&#39;AC8&#39;</span><span class="p">,</span> <span class="s1">&#39;AC2&#39;</span><span class="p">,</span> <span class="s1">&#39;AC4&#39;</span><span class="p">,</span> <span class="s1">&#39;AC6&#39;</span><span class="p">,</span> <span class="s2">&quot;AC2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AC3&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AC5&#39;&quot;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;nitrogen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;NH1&#39;</span><span class="p">,</span> <span class="s1">&#39;NH2&#39;</span><span class="p">,</span> <span class="s1">&#39;ND2&#39;</span><span class="p">,</span> <span class="s1">&#39;NE2&#39;</span><span class="p">,</span> <span class="s1">&#39;ND1&#39;</span><span class="p">,</span> <span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;NE1&#39;</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;NB&#39;</span><span class="p">,</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;NT&#39;</span><span class="p">,</span> <span class="s1">&#39;N9&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;N3&#39;</span><span class="p">,</span> <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;N7&#39;</span><span class="p">,</span> <span class="s1">&#39;N6&#39;</span><span class="p">,</span> <span class="s1">&#39;N4&#39;</span><span class="p">,</span> <span class="s1">&#39;N14&#39;</span><span class="p">,</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span> <span class="s1">&#39;NO1&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s2">&quot;NO5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NC5&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;NH5S&#39;</span><span class="p">,</span> <span class="s2">&quot;NH5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NC2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NH2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NO2&#39;&quot;</span><span class="p">,</span>
                    <span class="s1">&#39;NH2T&#39;</span><span class="p">,</span> <span class="s2">&quot;NC3&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NH3&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NO3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;NH3T&#39;</span><span class="p">,</span> <span class="s2">&quot;NC1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NH1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NC4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NH4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;NO4&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;NN1&#39;</span><span class="p">,</span> <span class="s1">&#39;NC6&#39;</span><span class="p">,</span> <span class="s1">&#39;NH6&#39;</span><span class="p">,</span> <span class="s1">&#39;NC5&#39;</span><span class="p">,</span> <span class="s1">&#39;NH5&#39;</span><span class="p">,</span> <span class="s1">&#39;NC4&#39;</span><span class="p">,</span> <span class="s1">&#39;NH4&#39;</span><span class="p">,</span> <span class="s1">&#39;NC3&#39;</span><span class="p">,</span> <span class="s1">&#39;NC2&#39;</span><span class="p">,</span> <span class="s1">&#39;NC7&#39;</span><span class="p">,</span> <span class="s1">&#39;NO7&#39;</span><span class="p">,</span> <span class="s1">&#39;NN7&#39;</span><span class="p">,</span> <span class="s1">&#39;NH71&#39;</span><span class="p">,</span> <span class="s1">&#39;NH72&#39;</span><span class="p">,</span> <span class="s1">&#39;NH42&#39;</span><span class="p">,</span> <span class="s1">&#39;AN7&#39;</span><span class="p">,</span> <span class="s1">&#39;AN9&#39;</span><span class="p">,</span> <span class="s1">&#39;AN1&#39;</span><span class="p">,</span> <span class="s1">&#39;AN3&#39;</span><span class="p">,</span> <span class="s1">&#39;AN6&#39;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;oxygen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;OD1&#39;</span><span class="p">,</span> <span class="s1">&#39;OD2&#39;</span><span class="p">,</span> <span class="s1">&#39;OE1&#39;</span><span class="p">,</span> <span class="s1">&#39;OE2&#39;</span><span class="p">,</span> <span class="s1">&#39;OG&#39;</span><span class="p">,</span> <span class="s1">&#39;OG1&#39;</span><span class="p">,</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;OH2&#39;</span><span class="p">,</span> <span class="s1">&#39;O1A&#39;</span><span class="p">,</span> <span class="s1">&#39;O2A&#39;</span><span class="p">,</span> <span class="s1">&#39;O1D&#39;</span><span class="p">,</span> <span class="s1">&#39;O2D&#39;</span><span class="p">,</span> <span class="s1">&#39;OY&#39;</span><span class="p">,</span> <span class="s1">&#39;OT1&#39;</span><span class="p">,</span> <span class="s1">&#39;OT2&#39;</span><span class="p">,</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="s1">&#39;O1P&#39;</span><span class="p">,</span> <span class="s1">&#39;O2P&#39;</span><span class="p">,</span> <span class="s2">&quot;O5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;O4&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;O6&#39;</span><span class="p">,</span> <span class="s2">&quot;O2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;O3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;O5T&#39;</span><span class="p">,</span> <span class="s1">&#39;O1P3&#39;</span><span class="p">,</span> <span class="s1">&#39;O2P3&#39;</span><span class="p">,</span> <span class="s1">&#39;O3T&#39;</span><span class="p">,</span> <span class="s1">&#39;O3P3&#39;</span><span class="p">,</span> <span class="s1">&#39;O13&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;O11&#39;</span><span class="p">,</span> <span class="s1">&#39;O12&#39;</span><span class="p">,</span> <span class="s1">&#39;O14&#39;</span><span class="p">,</span> <span class="s1">&#39;O22&#39;</span><span class="p">,</span> <span class="s1">&#39;O23&#39;</span><span class="p">,</span> <span class="s1">&#39;O24&#39;</span><span class="p">,</span> <span class="s1">&#39;O3A&#39;</span><span class="p">,</span> <span class="s1">&#39;O1B&#39;</span><span class="p">,</span> <span class="s1">&#39;O2B&#39;</span><span class="p">,</span> <span class="s1">&#39;O3B&#39;</span><span class="p">,</span> <span class="s1">&#39;O1G&#39;</span><span class="p">,</span> <span class="s1">&#39;O2G&#39;</span><span class="p">,</span> <span class="s1">&#39;O3G&#39;</span><span class="p">,</span> <span class="s1">&#39;O21&#39;</span><span class="p">,</span> <span class="s1">&#39;O3P&#39;</span><span class="p">,</span> <span class="s1">&#39;O31P&#39;</span><span class="p">,</span> <span class="s1">&#39;O32P&#39;</span><span class="p">,</span> <span class="s1">&#39;O33P&#39;</span><span class="p">,</span> <span class="s2">&quot;1O2&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;2O1P&#39;</span><span class="p">,</span> <span class="s1">&#39;2O2P&#39;</span><span class="p">,</span> <span class="s2">&quot;2O5&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AO4&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AO2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;AO3&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AO1&#39;</span><span class="p">,</span> <span class="s1">&#39;AO2&#39;</span><span class="p">,</span> <span class="s2">&quot;AO5&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;AO1P&#39;</span><span class="p">,</span> <span class="s1">&#39;AO2P&#39;</span><span class="p">,</span> <span class="s1">&#39;AO2T&#39;</span><span class="p">,</span> <span class="s1">&#39;OM&#39;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;sulfur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;1SG&#39;</span><span class="p">,</span> <span class="s1">&#39;2SG&#39;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;phosphorus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;P3&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">,</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="s1">&#39;2P&#39;</span><span class="p">,</span> <span class="s1">&#39;AP&#39;</span><span class="p">,</span> <span class="s1">&#39;AP2&#39;</span><span class="p">]</span>

        <span class="n">charmm_names</span><span class="p">[</span><span class="s1">&#39;other&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AS&#39;</span><span class="p">,</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;AC&#39;</span><span class="p">,</span> <span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;AU&#39;</span><span class="p">,</span> <span class="s1">&#39;BI&#39;</span><span class="p">,</span> <span class="s1">&#39;BE&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;BR&#39;</span><span class="p">,</span> <span class="s1">&#39;BA&#39;</span><span class="p">,</span> <span class="s1">&#39;CR&#39;</span><span class="p">,</span> <span class="s1">&#39;CS&#39;</span><span class="p">,</span> <span class="s1">&#39;CU&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;DY&#39;</span><span class="p">,</span> <span class="s1">&#39;EU&#39;</span><span class="p">,</span> <span class="s1">&#39;ER&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;FE&#39;</span><span class="p">,</span> <span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;HO&#39;</span><span class="p">,</span> <span class="s1">&#39;HF&#39;</span><span class="p">,</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;IR&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;KR&#39;</span><span class="p">,</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;LU&#39;</span><span class="p">,</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;OS&#39;</span><span class="p">,</span> <span class="s1">&#39;PD&#39;</span><span class="p">,</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span> <span class="s1">&#39;PM&#39;</span><span class="p">,</span> <span class="s1">&#39;PT&#39;</span><span class="p">,</span> <span class="s1">&#39;PO&#39;</span><span class="p">,</span> <span class="s1">&#39;RB&#39;</span><span class="p">,</span> <span class="s1">&#39;RU&#39;</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span> <span class="s1">&#39;RE&#39;</span><span class="p">,</span> <span class="s1">&#39;RN&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;SE&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span> <span class="s1">&#39;TI&#39;</span><span class="p">,</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;TE&#39;</span><span class="p">,</span> <span class="s1">&#39;TB&#39;</span><span class="p">,</span> <span class="s1">&#39;TA&#39;</span><span class="p">,</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="s1">&#39;TH&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;XE&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;YB&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;ZR&#39;</span><span class="p">,</span> <span class="s1">&#39;SS&#39;</span><span class="p">,</span> <span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;DUM&#39;</span><span class="p">,</span> <span class="s1">&#39;POT&#39;</span><span class="p">,</span> <span class="s1">&#39;CES&#39;</span><span class="p">,</span> <span class="s1">&#39;CLA&#39;</span><span class="p">]</span>

<span class="c1"># note that SM is C-S-S-C not Sm (the element)</span>
<span class="c1"># note that SM is C-S-S-C not Sm (the element)</span>

        <span class="k">return</span> <span class="n">charmm_names</span>


    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method is used by the self.read_topology method.</span>

<span class="sd">        It will check whether the key is in the dictionary:</span>
<span class="sd">        if yes, append value to dictionary[key]</span>
<span class="sd">        if no, initialize dictionary[key] as [value]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dictionary </span>
<span class="sd">            dictionary : containing existing key, value pairs</span>

<span class="sd">        key </span>
<span class="sd">            dictionary key : key to query and perhaps intialize</span>

<span class="sd">        value </span>
<span class="sd">            dictionary value : value add</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        updated dictionary</span>


<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">        &gt;&gt;&gt; d = {}</span>
<span class="sd">        &gt;&gt;&gt; d[&#39;ALA&#39;] = &#39;RESI ALA&#39;</span>
<span class="sd">        &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">        &gt;&gt;&gt; test.add(d, &#39;GLU&#39;, &#39;GLU&#39;)</span>
<span class="sd">        &gt;&gt;&gt; d</span>
<span class="sd">        {&#39;GLU&#39;: [&#39;GLU&#39;], &#39;ALA&#39;: &#39;RESI ALA&#39;} </span>
<span class="sd">        &gt;&gt;&gt; test.add(d, &#39;ASP&#39;, &#39;RESI ASP&#39;)</span>
<span class="sd">        &gt;&gt;&gt; d</span>
<span class="sd">        {&#39;ASP&#39;: [&#39;RESI ASP&#39;], &#39;GLU&#39;: [&#39;GLU&#39;], &#39;ALA&#39;: &#39;RESI ALA&#39;}</span>
<span class="sd">       </span>
<span class="sd">        &#39;&#39;&#39;</span> 
   
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
            <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">read_charmm_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topology_file_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">topology_file_name</span><span class="o">=</span><span class="s1">&#39;top_all27_prot_na.inp&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Read and parse the charmm topology file</span>
<span class="sd">        A comprehensive dictionary (topology_info) will be built to store all the topology information</span>
<span class="sd">        The strategy for parsing topology file is to split words in each line</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        topology_file_path </span>

<span class="sd">            string : default = &#39;&#39;</span>

<span class="sd">        topology_file_name </span>

<span class="sd">            string : default = &#39;top_all27_prot_na.inp&#39;</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import pprint</span>
<span class="sd">        &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">        &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">        &gt;&gt;&gt; test.read_charmm_topology()</span>
<span class="sd">        &gt;&gt;&gt; pprint.pprint(test.topology_info[&#39;NTER&#39;],width=100)</span>
<span class="sd">        {&#39;ATOM&#39;: [[&#39;N&#39;, &#39;NH3&#39;, &#39;-0.30&#39;],</span>
<span class="sd">            [&#39;HT1&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">            [&#39;HT2&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">            [&#39;HT3&#39;, &#39;HC&#39;, &#39;0.33&#39;],</span>
<span class="sd">            [&#39;CA&#39;, &#39;CT1&#39;, &#39;0.21&#39;],</span>
<span class="sd">            [&#39;HA&#39;, &#39;HB&#39;, &#39;0.10&#39;]],</span>
<span class="sd">        &#39;BOND&#39;: [[&#39;HT1&#39;, &#39;N&#39;], [&#39;HT2&#39;, &#39;N&#39;], [&#39;HT3&#39;, &#39;N&#39;]],</span>
<span class="sd">        &#39;DELE&#39;: [[&#39;ATOM&#39;, &#39;HN&#39;]],</span>
<span class="sd">        &#39;DONO&#39;: [&#39;HT1&#39;, &#39;N&#39;, &#39;HT2&#39;, &#39;N&#39;, &#39;HT3&#39;, &#39;N&#39;],</span>
<span class="sd">        &#39;IC&#39;: [[&#39;HT1&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;180.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;],</span>
<span class="sd">                [&#39;HT2&#39;, &#39;CA&#39;, &#39;*N&#39;, &#39;HT1&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;120.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;],</span>
<span class="sd">                [&#39;HT3&#39;, &#39;CA&#39;, &#39;*N&#39;, &#39;HT2&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;, &#39;120.0000&#39;, &#39;0.0000&#39;, &#39;0.0000&#39;]],</span>
<span class="sd">        &#39;TOTAL_CHARGE&#39;: &#39;1.00&#39;}</span>
<span class="sd">    </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        error</span>
<span class="sd">            list : with error code</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">    </span>
<span class="sd">        error code needs to be addressed and handled globally</span>


<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">topology_file_path</span><span class="p">,</span>
                                  <span class="n">topology_file_name</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MASS&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">,</span> <span class="s1">&#39;MASS&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
                <span class="c1">#</span>
                <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DECL&#39;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">,</span> <span class="s1">&#39;DECL&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="c1">#</span>
                <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DEFA&#39;</span><span class="p">:</span>  <span class="c1"># Need further parsing</span>
                    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">,</span> <span class="s1">&#39;DEFA&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="c1">#</span>
                <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;AUTO&#39;</span><span class="p">:</span>  <span class="c1"># Need further parsing</span>
                    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">,</span> <span class="s1">&#39;AUTO&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="c1">#</span>
                <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RESI&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PRES&#39;</span><span class="p">:</span>
                    <span class="n">cur_res</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">][</span><span class="s1">&#39;TOTAL_CHARGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="c1">#</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># elif &#39;cur_res&#39; in locals():</span>
                    <span class="c1">#</span>
                    <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                 <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BOND&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the BOND line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;BOND&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">2</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DOUB&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the DOUBLE line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;DOUB&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">2</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IMPR&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the IMPR line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;IMPR&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">4</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CMAP&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the CMAP line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;CMAP&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">4</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ANGL&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the ANGLE line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;ANGL&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">3</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;THET&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the THET line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;THET&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">3</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                                    <span class="ow">and</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the DIHE line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">4</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DONO&#39;</span><span class="p">:</span>  <span class="c1"># Need to check</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the DONOR line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;DONO&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACCE&#39;</span><span class="p">:</span>  <span class="c1"># Need to check</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">while</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;!&#39;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])):</span>
                                <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Something wrong with the ACCEPTOR line: </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">of residue: &#39;</span> <span class="o">+</span> <span class="n">cur_res</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="n">error</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                     <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;ACCE&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IC&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                 <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;IC&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BUIL&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                 <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;BUIL&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PATC&#39;</span><span class="p">:</span>  <span class="c1"># Need further parsing</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span>
                                 <span class="n">cur_res</span><span class="p">],</span> <span class="s1">&#39;PATC&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="c1">#</span>
                    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DELE&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;DELE&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">][</span><span class="s1">&#39;DELE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">prop</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">:</span>
                            <span class="c1"># Only 1 word  is parsed after &#39;DELE ATOM&#39;, which</span>
                            <span class="c1"># is ok for &quot;top_all27_prot_na.inp&quot;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">][</span>
                                     <span class="s1">&#39;DELE&#39;</span><span class="p">],</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s1">&#39;ANGL&#39;</span><span class="p">:</span>
                            <span class="c1"># Need further parsing</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">cur_res</span><span class="p">][</span>
                                     <span class="s1">&#39;DELE&#39;</span><span class="p">],</span> <span class="s1">&#39;ANGL&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># print &#39;WARNING!\n&#39;+line+&#39; NOT PARSED!\n&#39; #</span>
                            <span class="c1"># Current &quot;top_all27_prot_na.inp&quot; file only has</span>
                            <span class="c1"># DELE ATOM and DELE ANGL, and therefore other</span>
                            <span class="c1"># situations are not parsed but warned</span>
                            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">error</span>

    <span class="k">def</span> <span class="nf">patch_charmm_residue_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Applies &#39;patch&#39; to &#39;residue&#39; based on the charmm topology </span>
<span class="sd">        definition to add / remove atoms as needed.  Only ATOM and DELE</span>
<span class="sd">        records are accommodated</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        residue </span>
<span class="sd">            string : residue name</span>

<span class="sd">        patch</span>
<span class="sd">            string : patch name</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; molecule.check_charmm_atomic_order_reorganize()</span>
<span class="sd">        &gt;&gt;&gt; molecule.patch_charmm_residue_atoms(&#39;GLY&#39;,&#39;GLYP&#39;) </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        updated dictionary entry for residue in question</span>

<span class="sd">        Note</span>
<span class="sd">        ____</span>

<span class="sd">        Error list is defined and used, but not returned.  Needs to be handled globally.</span>

<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="c1"># OPEN: ONLY ATOMS ARE PATCHED (NO BOND, ETC)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#</span>
        <span class="c1"># Make sure residue and patch are the right type</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">residue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">:</span>
            <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Residue &#39;</span> <span class="o">+</span> <span class="n">residue</span> <span class="o">+</span>
                         <span class="s1">&#39; not found in the topology information list during patching!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error</span>
        <span class="k">elif</span> <span class="n">patch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">:</span>
            <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;Patch &#39;</span> <span class="o">+</span> <span class="n">residue</span> <span class="o">+</span> <span class="s1">&#39; not found in the topology information list during patching!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">error</span>
        <span class="c1">#</span>
        <span class="c1"># Delete atoms from &#39;DELE&#39; in patch list</span>
        <span class="c1">#</span>
        <span class="n">tmp_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">residue</span><span class="p">])</span>
        <span class="c1"># print &#39;ZHL &#39;,patch,self.topology_info[patch]</span>
        <span class="k">if</span> <span class="s1">&#39;DELE&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">patch</span><span class="p">][</span><span class="s1">&#39;DELE&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">atom_delete</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">patch</span><span class="p">][</span><span class="s1">&#39;DELE&#39;</span><span class="p">][</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">atom_residue</span> <span class="ow">in</span> <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">atom_delete</span> <span class="o">==</span> <span class="n">atom_residue</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">atom_residue</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Delete atoms</span>
        <span class="c1">#</span>
        <span class="n">num_added</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">atom_patch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">patch</span><span class="p">][</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">atom_residue</span> <span class="ow">in</span> <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">atom_residue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">atom_patch</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">atom_residue</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">patch</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NTER&#39;</span><span class="p">,</span> <span class="s1">&#39;GLYP&#39;</span><span class="p">,</span> <span class="s1">&#39;PROP&#39;</span><span class="p">]:</span>
                <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">num_added</span><span class="p">,</span> <span class="n">atom_patch</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">patch</span> <span class="o">==</span> <span class="s1">&#39;CTER&#39;</span><span class="p">:</span>
                <span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_patch</span><span class="p">)</span>
            <span class="n">num_added</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#</span>
        <span class="c1"># Add the patched residue to the topology dictionary as a new key of eg &#39;ALA_NTER&#39;</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="n">residue</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">patch</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span>
            <span class="n">residue</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">patch</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">])[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setup_cys_patch_atoms_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A way to set up cys patch atoms</span>
<span class="sd">        simply remove HG1 atom from the atom list</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">        &gt;&gt;&gt; import pprint</span>
<span class="sd">        &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">        &gt;&gt;&gt; test.read_charmm_topology()</span>
<span class="sd">        &gt;&gt;&gt; pprint.pprint(self.topology_info[&#39;CYS&#39;][&#39;ATOM&#39;])</span>
<span class="sd">        [[&#39;N&#39;, &#39;NH1&#39;, &#39;-0.47&#39;],</span>
<span class="sd">        [&#39;HN&#39;, &#39;H&#39;, &#39;0.31&#39;],</span>
<span class="sd">        [&#39;CA&#39;, &#39;CT1&#39;, &#39;0.07&#39;],</span>
<span class="sd">        [&#39;HA&#39;, &#39;HB&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;CB&#39;, &#39;CT2&#39;, &#39;-0.11&#39;],</span>
<span class="sd">        [&#39;HB1&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;HB2&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;SG&#39;, &#39;S&#39;, &#39;-0.23&#39;],</span>
<span class="sd">        [&#39;HG1&#39;, &#39;HS&#39;, &#39;0.16&#39;],</span>
<span class="sd">        [&#39;C&#39;, &#39;C&#39;, &#39;0.51&#39;],</span>
<span class="sd">        [&#39;O&#39;, &#39;O&#39;, &#39;-0.51&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; pprint.pprint(test.setup_cys_patch_atoms_simple(), width=80)</span>
<span class="sd">        [[&#39;N&#39;, &#39;NH1&#39;, &#39;-0.47&#39;],</span>
<span class="sd">        [&#39;HN&#39;, &#39;H&#39;, &#39;0.31&#39;],</span>
<span class="sd">        [&#39;CA&#39;, &#39;CT1&#39;, &#39;0.07&#39;],</span>
<span class="sd">        [&#39;HA&#39;, &#39;HB&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;CB&#39;, &#39;CT2&#39;, &#39;-0.11&#39;],</span>
<span class="sd">        [&#39;HB1&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;HB2&#39;, &#39;HA&#39;, &#39;0.09&#39;],</span>
<span class="sd">        [&#39;SG&#39;, &#39;S&#39;, &#39;-0.23&#39;],</span>
<span class="sd">        [&#39;C&#39;, &#39;C&#39;, &#39;0.51&#39;],</span>
<span class="sd">        [&#39;O&#39;, &#39;O&#39;, &#39;-0.51&#39;]] </span>

<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        updated dictionary entry for residue in question</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="p">[</span><span class="s1">&#39;CYS&#39;</span><span class="p">][</span><span class="s1">&#39;ATOM&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HG1&#39;</span><span class="p">:</span>
                <span class="n">atoms</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
        <span class="c1"># print atoms</span>
        <span class="k">return</span> <span class="n">atoms</span>

    <span class="k">def</span> <span class="nf">setup_charmm_residue_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        Build the atom list of all the residues in the charmm topology file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">        &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">        &gt;&gt;&gt; test.read_charmm_topology()</span>
<span class="sd">        &gt;&gt;&gt; test.setup_charmm_residue_atoms() </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self.charmm_residue_atoms : new dictionary entry for residue in question</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">topology_info</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;ATOM&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">atoms</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;ATOM&#39;</span><span class="p">])[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="c1"># OPEN Setup CYS patch atoms in a simple way</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="s1">&#39;DISU&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_cys_patch_atoms_simple</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">compare_list_ignore_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compare two lists while ignoring order</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        l1</span>
<span class="sd">            list : list 1 </span>

<span class="sd">        l2</span>
<span class="sd">            list : list 2</span>

<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>

<span class="sd">        &gt;&gt;&gt; import sasmol.topology as topology</span>
<span class="sd">        &gt;&gt;&gt; test = topology.CharmmTopology()</span>
<span class="sd">        &gt;&gt;&gt; l1 = [1, 2, 4]</span>
<span class="sd">        &gt;&gt;&gt; l2 = [2, 1, 4]</span>
<span class="sd">        &gt;&gt;&gt; test.compare_list_ignore_order(l1, l2)</span>
<span class="sd">        True </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Boolean</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">):</span>  <span class="c1"># make sure the lenght of two lists are the same</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">l1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l2</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Dont allow duplicate elements during compare</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">check_charmm_atomic_order_reorganize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        re-organize the atomic list according to the charmm topology contract</span>
<span class="sd">        do nothing if the atomic order alreay match that in the charmm topology file</span>
<span class="sd">        meanwhile make sure there are no missing or extra atoms</span>
<span class="sd">        H-atoms are required</span>
<span class="sd">        Patch N-ter for the first residue and C-ter for the last residue in each segment</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        kwargs </span>
<span class="sd">            optional future arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; import sasmol.system as system</span>
<span class="sd">        &gt;&gt;&gt; molecule = system.Molecule(&#39;hiv1_gag.pdb&#39;)</span>
<span class="sd">        &gt;&gt;&gt; molecule.check_charmm_atomic_order_reorganize()</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        error</span>
<span class="sd">            list : with error code</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">    </span>
<span class="sd">        error code needs to be addressed and handled globally</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">error</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bin_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">__bin_path__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_charmm_topology</span><span class="p">(</span><span class="n">topology_file_path</span><span class="o">=</span><span class="n">bin_path</span> <span class="o">+</span> <span class="s1">&#39;/toppar/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_charmm_residue_atoms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_children</span><span class="p">()</span>
        <span class="n">children_segname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_child</span><span class="p">(</span><span class="s1">&#39;segnames&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child_segname</span> <span class="ow">in</span> <span class="n">children_segname</span><span class="p">:</span>
            <span class="n">child_segname</span><span class="o">.</span><span class="n">initialize_children</span><span class="p">()</span>
            <span class="n">children</span> <span class="o">=</span> <span class="n">child_segname</span><span class="o">.</span><span class="n">init_child</span><span class="p">(</span><span class="s1">&#39;resids&#39;</span><span class="p">)</span>
            <span class="n">resid_nter</span> <span class="o">=</span> <span class="n">child_segname</span><span class="o">.</span><span class="n">resid</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">resid_cter</span> <span class="o">=</span> <span class="n">child_segname</span><span class="o">.</span><span class="n">resid</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                <span class="n">child_resname</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">resname</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">child_resid</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">resid</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">child_names</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
                <span class="n">child_indices</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
                <span class="c1">#</span>
                <span class="c1"># print child_resname,self.charmm_residue_atoms[child_resname], child_names</span>
                <span class="c1"># print</span>
                <span class="c1"># self.compare_list_ignore_order(self.charmm_residue_atoms[child_resname],</span>
                <span class="c1"># child_names)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_list_ignore_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">],</span> <span class="n">child_names</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">child_resname</span> <span class="o">==</span> <span class="s1">&#39;CYS&#39;</span><span class="p">:</span>
                        <span class="n">child_resname</span> <span class="o">=</span> <span class="s1">&#39;DISU&#39;</span>  <span class="c1"># OPEN: try DISU if CYS doesnt work</span>
                    <span class="k">if</span> <span class="n">child_resname</span> <span class="o">==</span> <span class="s1">&#39;HIS&#39;</span><span class="p">:</span>
                        <span class="n">child_resname</span> <span class="o">=</span> <span class="s1">&#39;HSE&#39;</span>  <span class="c1"># OPEN: try HSE if HIS doesnt work</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_list_ignore_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">],</span> <span class="n">child_names</span><span class="p">):</span>
                            <span class="n">child_resname</span> <span class="o">=</span> <span class="s1">&#39;HSD&#39;</span>  <span class="c1"># OPEN: try HSD if HIS doesnt work</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_list_ignore_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">],</span> <span class="n">child_names</span><span class="p">):</span>
                                <span class="n">child_resname</span> <span class="o">=</span> <span class="s1">&#39;HSP&#39;</span>  <span class="c1"># OPEN: try HSP if HIS doesnt work</span>
                    <span class="k">if</span> <span class="n">child_resid</span> <span class="o">==</span> <span class="n">resid_nter</span><span class="p">:</span>
                            <span class="c1"># print child_resname</span>
                        <span class="k">if</span> <span class="n">child_resname</span> <span class="o">==</span> <span class="s1">&#39;GLY&#39;</span><span class="p">:</span>
                            <span class="n">patch</span> <span class="o">=</span> <span class="s1">&#39;GLYP&#39;</span>
                        <span class="k">elif</span> <span class="n">child_resname</span> <span class="o">==</span> <span class="s1">&#39;PRO&#39;</span><span class="p">:</span>
                            <span class="n">patch</span> <span class="o">=</span> <span class="s1">&#39;PROP&#39;</span>
                        <span class="k">elif</span> <span class="n">child_resname</span> <span class="o">==</span> <span class="s1">&#39;PROP&#39;</span><span class="p">:</span>
                            <span class="n">patch</span> <span class="o">=</span> <span class="s1">&#39;PROP&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">patch</span> <span class="o">=</span> <span class="s1">&#39;NTER&#39;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">patch_charmm_residue_atoms</span><span class="p">(</span><span class="n">child_resname</span><span class="p">,</span> <span class="n">patch</span><span class="p">)</span>
                        <span class="n">child_resname</span> <span class="o">=</span> <span class="n">child_resname</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">patch</span>
                    <span class="k">if</span> <span class="n">child_resid</span> <span class="o">==</span> <span class="n">resid_cter</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">patch_charmm_residue_atoms</span><span class="p">(</span><span class="n">child_resname</span><span class="p">,</span> <span class="s1">&#39;CTER&#39;</span><span class="p">)</span>
                        <span class="n">child_resname</span> <span class="o">=</span> <span class="n">child_resname</span> <span class="o">+</span> <span class="s1">&#39;_CTER&#39;</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_list_ignore_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">],</span> <span class="n">child_names</span><span class="p">):</span>
                        <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;For residue: &quot;</span> <span class="o">+</span> <span class="n">child_resname</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">the atom names doesn&#39;t match those in the charmm topology file!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">child_names</span><span class="p">))</span>
                        <span class="k">return</span> <span class="n">error</span>
                <span class="c1">#</span>
                <span class="c1"># if self.charmm_residue_atoms[child_resname] == child_names:</span>
                <span class="c1">#	continue</span>
                <span class="c1">#import pprint</span>
                <span class="c1"># pprint.pprint(child_resname)</span>
                <span class="c1"># pprint.pprint(self.charmm_residue_atoms[child_resname],width=100)</span>
                <span class="n">new_indices</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">charmm_residue_atoms</span><span class="p">[</span><span class="n">child_resname</span><span class="p">]:</span>
                    <span class="n">new_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">child_indices</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_indices</span><span class="p">):</span>
                    <span class="n">error</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Number of atoms doesnt match that in charmm topology file for </span><span class="se">\n</span><span class="s1">resname: &#39;</span> <span class="o">+</span>
                                 <span class="n">child_resname</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">and resid: &#39;</span> <span class="o">+</span> <span class="n">child_resid</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">error</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">child_indices</span><span class="p">)):</span>
                    <span class="c1"># if child_indices[i]!=new_indices[i]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">atom</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="c1">#self.index()[indices[i]-1] = child.index[new_indices[i]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                               <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">loc</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resname</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">resname</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                 <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">chain</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resid</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                 <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">resid</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rescode</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">rescode</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                     <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">occupancy</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">beta</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">segname</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">segname</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">element</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">()[</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                  <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">charge</span><span class="p">()[</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="c1"># only frame-0 was handled in subset.init_child</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">child_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">coor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">new_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">error</span>


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Joseph E. Curtis, Ph.D.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
    </div>

    

    
  </body>
</html>